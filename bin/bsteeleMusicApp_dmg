#!/bin/tcsh
#set echo; set verbose

set bs=~/github/bsteele_music_flutter
set dmg=installers/dmg_creator

cd $bs

flutter clean
flutter build macos --release
set stat=$status
if ( $stat != 0 ) exit $stat

cd ~/junk

rm -rf $dmg
mkdir -p installers/dmg_creator
cd installers/dmg_creator

cp $bs/bin/config.json .
cp $bs/build/macos/Build/Products/Release/bsteele_music_flutter.app/Contents/Resources/AppIcon.icns .

appdmg $bs/bin/dmgConfig.json bsteeleMusicApp.dmg
exit $status


